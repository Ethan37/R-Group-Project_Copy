---
title: "Team_project"
author: "S01-Blue"
output: html_document
---

```{r load-packages, message=FALSE}
library(tidyverse)
library(gridExtra)
```

```{r load-data}
video_game_sales <- read.csv("data/Video_Games_Sales_as_at_22_Dec_2016.csv")

glimpse(video_game_sales)
```

### What games are on more than one platform?

```{r Plat-freq-check}
GTOnePlatform <- video_game_sales %>% 
  filter(Platform %in% c("XB","X360","XOne","PS","PS2","PS3","PS4","PC")) %>% 
  group_by(Name) %>% 
  summarise(numplats = n()) %>% 
  filter(numplats>1)
```

```{r make-dataset}
GTMerge <- video_game_sales %>% 
  filter(Platform %in% c("XB","X360","XOne","PS","PS2","PS3","PS4","PC")) %>% 
  right_join(GTOnePlatform, by = c("Name" = "Name"))
```

### Total sales of game predicted by type of game and developer

```{r type-freq-check}
by_genre <- video_game_sales %>% 
  group_by(Genre) %>% 
  summarise(Count = n())
  ##filter(Count > 1)
```



### T-test

```{r average-total-sales}
video_game_sales %>%
  arrange(Platform) %>%
  count(Platform)

xbox_playstation <- video_game_sales %>%
  filter(Platform %in% "XOne" | 
           Platform %in% "XB" |
           Platform %in% "X360" |
           Platform %in% "PS" |
           Platform %in% "PS2" |
           Platform %in% "PS3" |
           Platform %in% "PS4" |
           Platform %in% "PSP" |
           Platform %in% "PSV"
         )

xbox_playstation %>%
  count(Platform)

system_var <- xbox_playstation %>%
  mutate(System = case_when(
    Platform %in% c("XOne", "XB", "X360") ~ "Xbox",
    Platform %in% c("PS", "PS2", "PS3", "PS4", "PSP", "PSV") ~ "PlayStation"
  ))

test <- system_var %>%
  select(Platform, System, Global_Sales) %>%
  arrange(System)

averages <- test %>%
  group_by(System) %>%
  summarise(n = n(), sum_sales = sum(Global_Sales), avg = mean(Global_Sales))
```


```{r summary-stats}
testing_data <- test %>%
  select(System,Global_Sales)

testing_data %>%
  filter(System == "Xbox") %>%
  summary()

testing_data %>%
  filter(System == "PlayStation") %>%
  summary()
```

```{r plots}

xbox <- tesing_data %>%
  filter(System == "Xbox")

playstation <- testing_data %>%
  filter(System == "PlayStation")



p1 <- ggplot(data = testing_data, mapping = aes(System, Global_Sales)) +
  geom_boxplot() +
  labs(title = "Box Plots of Global Sales", subtitle = "by System", y = "Global Sales")

logp1 <- ggplot(data = testing_data, mapping = aes(System, Global_Sales)) +
  geom_boxplot() +
  scale_y_log10() +
  labs(title = "Box Plots of Global Sales", subtitle = "by System", y = "log(Global Sales)")

p2 <- ggplot(data = xbox, mapping = aes(Global_Sales)) +
  geom_histogram(stat = 'bin', binwidth = 0.1, na.rm = TRUE) +
  xlim(0,10) +
  labs(title = "Histogram of Global Sales", subtitle = "for Xbox", x= "Global Sales", y = "Count")

p3 <- ggplot(data = playstation, mapping = aes(Global_Sales)) +
  geom_histogram(stat = 'bin', binwidth = 0.1, na.rm = TRUE) +
  xlim(0,10) +
  labs(title = "Histogram of Global Sales", subtitle = "for PlayStation", x= "Global Sales", y = "Count")

logp2 <- ggplot(data = xbox, mapping = aes(Global_Sales)) +
  geom_histogram(stat = 'bin', binwidth = 0.1) +
  scale_x_log10() +
  labs(title = "Histogram of Global Sales", subtitle = "for Xbox", x= "log(Global Sales)", y = "Count")

logp3 <- ggplot(data = playstation, mapping = aes(Global_Sales)) +
  geom_histogram(stat = 'bin', binwidth = 0.1) +
  scale_x_log10() +
  labs(title = "Histogram of Global Sales", subtitle = "for PlayStation", x= "log(Global Sales)", y = "Count")


grid.arrange(p1,logp1, nrow=1)
grid.arrange(p2, logp2, nrow=1)
grid.arrange(p3, logp3, nrow=1)
```








